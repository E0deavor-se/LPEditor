@using LPEditorApp.Models

<div class="sectionNav-rowWrapper item @(IsHidden ? "is-hidden" : "")" data-id="@Group.Key">
    <div id="@RowId" class="sectionNav-row @(IsCurrent ? "is-current" : "") @(IsSelected ? "is-selected" : "") @(IsOpen ? "is-open" : "")" @onclick="OnSelect">
        <div class="sectionNav-handle drag-handle" title="ä¸¦ã³æ›¿ãˆ" @onclick:stopPropagation="true">â‹®â‹®</div>
        <div class="sectionNav-icon" title="@IconLabel">@Icon</div>
        <div class="sectionNav-main" @ondblclick="OnToggleOpen">
            <div class="sectionNav-title">@Title</div>
            <div class="sectionNav-sub">
                <span>@SubText</span>
                <span class="sectionNav-id">ID: @Group.Key</span>
            </div>
        </div>
        <div class="sectionNav-actions" @onclick:stopPropagation="true">
            <button type="button" class="sectionNav-btn sectionNav-expand @(IsOpen ? "is-open" : "")" title="@(IsOpen ? "è©³ç´°ã‚’é–‰ã˜ã‚‹" : "è©³ç´°ã‚’é–‹ã")" @onclick="OnToggleOpen" aria-expanded="@IsOpen">â–¾</button>
            <label class="toggle-switch sectionNav-toggle">
                <input type="checkbox" checked="@IsVisible" @onchange="OnToggleChanged" />
                <span class="toggle-label">è¡¨ç¤º</span>
            </label>
            <button type="button" class="sectionNav-btn is-primary" title="ç·¨é›†" @onclick="OnEdit">ğŸ“</button>
            <button type="button" class="sectionNav-btn" title="è£…é£¾" @onclick='() => OnQuickAction.InvokeAsync("decor")'>ğŸ¨</button>
            <button type="button" class="sectionNav-btn" title="èƒŒæ™¯" @onclick='() => OnQuickAction.InvokeAsync("background")'>ğŸ–¼</button>
            <button type="button" class="sectionNav-btn" title="ã‚¸ãƒ£ãƒ³ãƒ—" @onclick='() => OnQuickAction.InvokeAsync("scroll")'>â¤µ</button>
            <details class="sectionNav-menu">
                <summary class="sectionNav-btn" title="ãƒ¡ãƒ‹ãƒ¥ãƒ¼">â‹¯</summary>
                <div class="sectionNav-menuList">
                    <button type="button" class="sectionNav-menuItem" @onclick="OnToggleOpen">@(IsOpen ? "è©³ç´°ã‚’é–‰ã˜ã‚‹" : "è©³ç´°ã‚’é–‹ã")</button>
                    <button type="button" class="sectionNav-menuItem" @onclick='() => OnMenuAction.InvokeAsync("delete")'>å‰Šé™¤</button>
                </div>
            </details>
        </div>
    </div>
    @if (IsOpen && ChildContent is not null)
    {
        <div class="section-card-body">
            @ChildContent
        </div>
    }
</div>

@code {
    [Parameter] public SectionGroupModel Group { get; set; } = new();
    [Parameter] public string RowId { get; set; } = string.Empty;
    [Parameter] public string Title { get; set; } = string.Empty;
    [Parameter] public string SubText { get; set; } = string.Empty;
    [Parameter] public string Icon { get; set; } = string.Empty;
    [Parameter] public string IconLabel { get; set; } = string.Empty;
    [Parameter] public bool IsCurrent { get; set; }
    [Parameter] public bool IsSelected { get; set; }
    [Parameter] public bool IsVisible { get; set; }
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public bool IsHidden { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }

    [Parameter] public EventCallback OnSelect { get; set; }
    [Parameter] public EventCallback OnEdit { get; set; }
    [Parameter] public EventCallback<ChangeEventArgs> OnToggleChanged { get; set; }
    [Parameter] public EventCallback OnToggleOpen { get; set; }
    [Parameter] public EventCallback<string> OnQuickAction { get; set; }
    [Parameter] public EventCallback<string> OnMenuAction { get; set; }
}
